[PPT 1장]
이번 시간에는 Airflow를 사용하기에 앞서 Airflow가 무엇인지 어떤 장점이 있는지 알아보도록 하겠습니다.
먼저 Airflow의 정의에 대해서 보겠습니다.
Airflow는 파이썬 프로그래밍 언어를 이용하여 워크플로우를 만들고 관리할 수 있는 오픈소스 기반의 워크플로우 관리 도구 입니다.
2014년에 에어비엔비에서 만들기 시작했고 최근에는 Apache 오픈소스 재단에서 Top tier로 관리되고 있는 프로젝트입니다. 

다음은 Airflow의 특징을 보겠습니다.
첫 번째로, 앞서 설명드린대로 Airflow는 파이썬 언어로 제작되었고 이용자가 워크플로우를 만들 떄에도 파이썬을 이용해서 직접 프로그래밍 해줘야 합니다.
두 번째로 워크플로우는 Directed Acyclic Graph라고 해서 댁이라 부르기도 하고 디.에이.쥐라고 부르기도 하는데 저는 DAG이라고 부르겠습니다. 
  즉 워크플로우는 곧 댁이라 부르고 댁 안에는 1개 이상의 task가 존재하는 구조로 돼있습니다.
  Task가 무엇인지 지금은 와닿지 않을텐데요, 예를 들어보겠습니다.
   Python 함수를 실행해서 REST API로 데이터를 받아오고 데이터 전처리를 하는 작업이 있고
   이 작업이 완료된 후에 DB에 데이터를 지우는 Task가 진행되고,
   이 작업 후에 DB에 Insert 하는 작업이 있다고 해볼꼐요.
   그럼 이 3가지 하나하나가 Task가 됩니다. 
   즉 Task는 여러분들이 워크플로우를 통해서 만들기 원하는 작업 절차들이고
   작업 절차는 여러분들이 파이썬으로 어떻게 프로그래밍하냐에 따라 달라지게 됩니다. 
세 번째 특징을 보겠습니다.
세 번째 특징으로 DAG에 존재하는 Task들은 방향성을 가지고 있고 순환되지 않는 형태로 선후행 의존관계를 맺게 됩니다. 
밑에 캡쳐한 그림은 Airflow의 샘플 DAG인데요. 7개의 Task가 존재하는걸 볼 수 있고 
각 Task들은 방향성을 가지고 있고 순환되지 않는 형태인 것을 알 수 있습니다. 
네 번째 특징으로 Cron 기반의 스케줄링이 가능하다 인데요.
 Cron 스케줄은 리눅스 시스템에서 주로 쓰는 방법인데 Job이 언제 돌아야 하는지를 문자열로 표현 가능한 방법입니다. 이 부분은 나중에 DAG을 만들면서 별도로 설명드리도록 하겠습니다. 
다섯 번째 특징은 모니터링 기능과 실패했을 때 재작업 처리가 간편하다는 것인데요,
 위에서 본 그림에서 짙은 초록색은 Task가 잘 완료된 것을 의미합니다.
 반면 옅은 녹색은 Task가 수행중이라는 의미이고 
 회색으로 표시된다면 Task가 Queue에 들어가있고 아직 시작되지 않은 상태를 의미합니다.
그리고 분홍색은 Task가 Skip되었다 라는 것을 의미합니다.
그래서 airflow는 task들의 상태를 확인하기가 쉽고 실패했을 때 재실행할 수 있는 기능도 잘 갖춰져있다고 이해하시면 되겠습니다. 


--------------------------------------------------------------------------
[PPT 2장]
이번에는 왜 Airflow가 인기 많은지 설명하도록 하겠습니다. 
먼저 밑에 나온 그래프는 크플로우 관리도구 순위 중에서 Github에서 인기많은 순위를 나타낸 것인데요, 
파란색 선이 Airflow입니다. 
분홍색이 루이지, 노란색이 MLflow, 보라색하고 빨간색이 kubeflow, argo-workflow 입니다. 
그런데 이 순위가 도구들을 많이 쓰고 있는 순위는 아닙니다.  Github에 보면 SNS의 좋아요처럼 star 라는게 있습니다. star 버튼을 클릭해두면 즐겨찾기해둔 것처럼 나중에 찾아가기 편리하게 되는데요. 이 그래프는 사람들이 star 표시해 둔 개수를 의미합니다. 
어쨌든 그 만큼 사람들에게 인기 많다고 볼 수 있다. 그렇게 이해하시면 됩니다.

저는 여기 있는 모든 도구들을 써보진 않았고 Airflow만 써봤습니다.
그래서 다른 도구들 대비 Airflow가 어떤 장점이 있는지 자세히 설명드릴 수는 없지만,
자료를 찾다보니 잘 정리해 놓은 자료가 있어서 이걸로 설명을 대신하려고 합니다. 

하나씩 볼께요.
먼저 Maturity는 성숙도입니다. 이 지표는 github에서 얼마나 commit 활동이 활발히 일어나고 있냐를 기준으로 매긴 점수입니다. 
Luigi와 airflow가 상대적으로 활동이 활발한 것을 볼 수 있습니다.
이 지표가 꽤 의미를 갖는 이유가 만약에 우리가 워크플로우 관련한 유료 솔루션을 사용한다면 보안 이슈가 나타난다거나 버그를 발견하면 제작사에 요청해서 Fix 패치를 적용할 수가 있습니다. 그런데 오픈소스는 그런게 없어요. 내가 직접 bug를 고치거나 누군가 고친 버전을 적용해줄 때까지 기다려야 합니다. 따라서 오픈소스 관리가 얼마나 활발히 이루어지냐도 중요한 측면입니다. 

그 다음 항목은 인기도입니다. 인기도는 위 그래프에서 본 star 개수를 의미해요.
즉 좋아요 표시를 얼마나 많이 했냐의 의미이고, 그래프의 Y축과 동일하기 때문에 Airflow가 압도적으로 인기가 많다고 볼 수 있습니다.

그 다음은 단순성입니다. 즉 사용하기에 얼마나 단순하냐인데 
아쉽게도 Airflow는 사용하기가 쉽지는 않습니다.
왜냐면 모든 것을 파이썬 프로그래밍으로 만들어야 하고, 더 잘 쓰려면
객체지향의 상속같은 개념을 아셔야해요. 그래서 익숙해질때까지 러닝커브가 좀 있습니다. 

다음은 브레쓰입니다. 브레쓰는 폭이라는 의미인데요, 
쉽게 생각하면 확장성입니다. 
이건 단순성하고 연계해서 생각하면 편한데 Airflow는 쓰기 어려운만큼 자유도가 높습니다. 
즉 내 프로젝트에 맞는 방법으로 커스터마이징하기 편하게 돼있어요.
그래서 프로젝트내 이런저런 기능이 필요한데, 어떡하지? 하면 만들어서 쓰면 됩니다. Airflow 자체가 그런 커스터마이징을 하기 쉽도록 만들어져있어요.

지금 설명드린 모든 것을 요약하면 오른쪽에 보시는것과 같습니다.
여러분들 RPG 게임같은거 해보시면 자유도가 낮을수록 진행하기 쉽고
자유도가 높을수록 초보자가 하기는 어렵지만 이것저것 재밌게 할 수 있잖아요?
Airflow는 게임으로 비유하자면 자유도가 높아서 처음에 쓰기는 좀 어렵지만 
익숙해지면 할 수 있는 것들이 많은 게임이라고 할 수 있습니다. 


[PPT3장]
그다음은 Airflow의 장단점을 보도록 하겠습니다.
첫 번째 장점은, 파이썬에 익숙하다면 러닝 커브를 빠르게 극복할 수 있다는 것입니다. 이 부분은 앞에서 많이 설명드려서 이해하실거라 보구요.
두 번째 장점은, 대규모 환경에서도 적용할 수 있는 아키텍처가 있다는 건데요.
요즘은 도커라는 것을 많이 쓰지요? 쉽게 생각하면 경량화된 가상화서버라고 볼  수 있는데 
이 쿠버네티스는 도커를 오케스트레이션, 관리할 수 있는 솔루션을 의미합니다. 
Airflow 자체를 쿠버네티스위에 올릴 수 있어서 대규모 환경에서 서버의 스펙을 높이는 것이 아닌 서버를 더 두어서 부하를 분산시키는 방식으로 대응이 가능합니다.
만약 아키텍처에 크게 관심이 없으시다면 2번 항목은 그냥 모르셔도 되구요, 그냥 대규모환경에서도 쓸 수 있구나, 정도로 생각하셔도 괜찮습니다.

세 번째 장점은 파이썬 라이브러리를 이용해서 아주 많은 도구들을 컨트롤할 수 있습니다.
요즘엔 클라우드 많이 쓰죠? AWS, GCP, Azure 등을 많이 쓰는데 예를 들어 AWS에 보면 
EC2, S3, RDS 같은 대표적인 솔루션들이 있습니다. 그런데 이런 솔루션들은 파이썬을 통해 조작할 수 있도록 파이썬 API를 많이 제공해주고 있어요. 그 말은 파이썬 API를 이용하면 에어플로우에서도 이런 도구들을 컨트롤할 수 있다는 의미입니다. 

네 번째 장점은 제가 생각할 때 Airflow의 꽃입니다. 
뭐냐면 Airflow는 확장성이 좋다고 말씀드렸는데 Airflow는 오퍼레이터, Hook, 센서 같은 객체를 이용해서 워크플로우를 만들게 되는데 이런 객체들을 여러분이 원하는 형태로 제작이 가능합니다. 
특히 대규모 프로젝트 환경을 하다보면 이런저런 요건들이 많이 생기죠? 
그런 요건들을 만족하기 위해 오퍼레이터를 커스터마이징해서 만든다던지 하는 것이 가능합니다. 

마지막으로 AIrflow의 단점을 보도록 하겠습니다. 

첫 번째로 실시간 워크플로우 관리에는 적합하지 않습니다.
	워크플로우의 스케줄링은 보통 분단위로 수행합니다. 그것도 만약에 수행 주기를 1분으로 설정한다 하더라도 꼭 1분마다 돈다는 보장이 없습니다. 
	Airflow의 부하 상황에 따라 가끔 2분만에 돈다거나 3분만에 돈다거나 하는 현상이 나타나기도 합니다. 
    그래서 초 단위 실행이나 1분 단위 실행, 이런 워크플로우에는 적합하지 않다고 볼 수 있구요.
두 번째로 DAG이 많아질 경우 모니터링이 쉽지 않다는 것입니다. 
이건 지금은 와닿지 않겠지만 Airflow를 직접 설치해서 들어가보면 아마 아실거에요.

세 번째로 워크플로우를 GUI 환경에서 만들지 않고 파이썬 프로그래밍으로 직접 코드를 짜야합니다. 특히 여러분들이 협업환경하에 다른 사람들과 DAG을 같이 만든다고 하면 
프로그래밍 표준없으면 DAG 을 만드는 스타일이 다 다르게 됩니다. 그러면 남이 짠 DAG을 이해하기 힘들 수 있어요. 그래서 대규모 환경에서는 DAG 프로그래밍 일관성을 유지하기 위해 표준같은게 필요할 수 있습니다. 

자 그럼 Airflow에 대한 소개는 여기까지 하구요.
다음시간에는 AIrflow를 여러분의 컴퓨터에 설치하기 위해 WSL을 설치해보도록 하겠습니다. 
감사합니다. 